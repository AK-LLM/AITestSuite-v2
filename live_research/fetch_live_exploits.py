import feedparser
import os
from datetime import datetime

LIVE_RESEARCH_DIR = "./live_research/"
os.makedirs(LIVE_RESEARCH_DIR, exist_ok=True)

# Change this query to suit your interest
ARXIV_QUERY = "cat:cs.CR+AND+adversarial+attack"
RSS_FEED = f"https://export.arxiv.org/api/query?search_query={ARXIV_QUERY}&sortBy=submittedDate&sortOrder=descending&max_results=5"

feed = feedparser.parse(RSS_FEED)

for entry in feed.entries:
    title = entry.title.replace(" ", "_").replace("/", "_").replace("\\", "_")
    fname = f"{LIVE_RESEARCH_DIR}{title}_{datetime.now().strftime('%Y%m%d')}.txt"
    with open(fname, "w", encoding="utf-8") as f:
        f.write(f"Title: {entry.title}\n")
        f.write(f"Authors: {entry.author}\n")
        f.write(f"Summary: {entry.summary}\n")
        f.write(f"Link: {entry.link}\n\n")

print(f"Fetched {len(feed.entries)} new arXiv research cases to {LIVE_RESEARCH_DIR}")
